{"ast":null,"code":"import{useState}from'react';import{Form,Button,Container,Alert}from'react-bootstrap';import{useNavigate}from'react-router-dom';import axios from'axios';import{useAuth}from'../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CreateBlog=()=>{const{user}=useAuth();// Ottieni i dati dell'utente loggato\nconst navigate=useNavigate();const[error,setError]=useState('');const[coverImage,setCoverImage]=useState(null);const[previewUrl,setPreviewUrl]=useState('');const[formData,setFormData]=useState({title:'',content:'',category:'',readTime:{value:1,unit:'minuti'}});const handleImageChange=e=>{const file=e.target.files[0];if(file){setCoverImage(file);setPreviewUrl(URL.createObjectURL(file));}};const handleSubmit=async e=>{e.preventDefault();setError('');// Controllo che tutti i campi siano compilati\nif(!formData.title||!formData.content||!formData.category){setError('Tutti i campi sono obbligatori.');return;}if(!coverImage){setError(\"L'immagine di copertina è obbligatoria.\");return;}try{const blogData=new FormData();blogData.append('title',formData.title);blogData.append('content',formData.content);blogData.append('category',formData.category);blogData.append('author',user._id);// Imposta l'autore come l'utente loggato\nblogData.append('readTime',JSON.stringify({value:parseInt(formData.readTime.value),unit:formData.readTime.unit}));blogData.append('cover',coverImage);const response=await axios.post('http://localhost:3001/blogs',blogData,{headers:{'Content-Type':'multipart/form-data'}});if(response.data){navigate('/my-blogs');// Reindirizza alla pagina dei blog dell'utente\n}}catch(err){var _err$response,_err$response$data;console.error('Errore durante la creazione:',err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Errore durante la creazione del blog');}};return/*#__PURE__*/_jsxs(Container,{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Crea Nuovo Blog\"}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Titolo\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:formData.title,onChange:e=>setFormData({...formData,title:e.target.value}),required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Categoria\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:formData.category,onChange:e=>setFormData({...formData,category:e.target.value}),required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Immagine di Copertina\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"file\",accept:\"image/*\",onChange:handleImageChange,required:true}),previewUrl&&/*#__PURE__*/_jsx(\"img\",{src:previewUrl,alt:\"Preview\",className:\"mt-2\",style:{maxWidth:'200px'}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Contenuto\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:5,value:formData.content,onChange:e=>setFormData({...formData,content:e.target.value}),required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Tempo di Lettura\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsx(Form.Control,{type:\"number\",value:formData.readTime.value,onChange:e=>setFormData({...formData,readTime:{...formData.readTime,value:parseInt(e.target.value)||1}}),required:true,min:\"1\"}),/*#__PURE__*/_jsxs(Form.Select,{value:formData.readTime.unit,onChange:e=>setFormData({...formData,readTime:{...formData.readTime,unit:e.target.value}}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"minuti\",children:\"Minuti\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ore\",children:\"Ore\"})]})]})]}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Crea Blog\"})]})]});};export default CreateBlog;","map":{"version":3,"names":["useState","Form","Button","Container","Alert","useNavigate","axios","useAuth","jsx","_jsx","jsxs","_jsxs","CreateBlog","user","navigate","error","setError","coverImage","setCoverImage","previewUrl","setPreviewUrl","formData","setFormData","title","content","category","readTime","value","unit","handleImageChange","e","file","target","files","URL","createObjectURL","handleSubmit","preventDefault","blogData","FormData","append","_id","JSON","stringify","parseInt","response","post","headers","data","err","_err$response","_err$response$data","console","className","children","variant","onSubmit","Group","Label","Control","type","onChange","required","accept","src","alt","style","maxWidth","as","rows","min","Select"],"sources":["C:/Users/esis/Downloads/M6W4D4/frontend/src/pages/CreateBlog.jsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { Form, Button, Container, Alert } from 'react-bootstrap';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\nconst CreateBlog = () => {\r\n  const { user } = useAuth(); // Ottieni i dati dell'utente loggato\r\n  const navigate = useNavigate();\r\n  const [error, setError] = useState('');\r\n  const [coverImage, setCoverImage] = useState(null);\r\n  const [previewUrl, setPreviewUrl] = useState('');\r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    content: '',\r\n    category: '',\r\n    readTime: { value: 1, unit: 'minuti' },\r\n  });\r\n\r\n  const handleImageChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setCoverImage(file);\r\n      setPreviewUrl(URL.createObjectURL(file));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError('');\r\n\r\n    // Controllo che tutti i campi siano compilati\r\n    if (!formData.title || !formData.content || !formData.category) {\r\n      setError('Tutti i campi sono obbligatori.');\r\n      return;\r\n    }\r\n\r\n    if (!coverImage) {\r\n      setError(\"L'immagine di copertina è obbligatoria.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const blogData = new FormData();\r\n      blogData.append('title', formData.title);\r\n      blogData.append('content', formData.content);\r\n      blogData.append('category', formData.category);\r\n      blogData.append('author', user._id); // Imposta l'autore come l'utente loggato\r\n      blogData.append('readTime', JSON.stringify({\r\n        value: parseInt(formData.readTime.value),\r\n        unit: formData.readTime.unit,\r\n      }));\r\n      blogData.append('cover', coverImage);\r\n\r\n      const response = await axios.post('http://localhost:3001/blogs', blogData, {\r\n        headers: { 'Content-Type': 'multipart/form-data' },\r\n      });\r\n\r\n      if (response.data) {\r\n        navigate('/my-blogs'); // Reindirizza alla pagina dei blog dell'utente\r\n      }\r\n    } catch (err) {\r\n      console.error('Errore durante la creazione:', err);\r\n      setError(err.response?.data?.error || 'Errore durante la creazione del blog');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container className=\"mt-4\">\r\n      <h2>Crea Nuovo Blog</h2>\r\n      {error && <Alert variant=\"danger\">{error}</Alert>}\r\n      \r\n      <Form onSubmit={handleSubmit}>\r\n        <Form.Group className=\"mb-3\">\r\n          <Form.Label>Titolo</Form.Label>\r\n          <Form.Control\r\n            type=\"text\"\r\n            value={formData.title}\r\n            onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n            required\r\n          />\r\n        </Form.Group>\r\n\r\n        <Form.Group className=\"mb-3\">\r\n          <Form.Label>Categoria</Form.Label>\r\n          <Form.Control\r\n            type=\"text\"\r\n            value={formData.category}\r\n            onChange={(e) => setFormData({ ...formData, category: e.target.value })}\r\n            required\r\n          />\r\n        </Form.Group>\r\n\r\n        <Form.Group className=\"mb-3\">\r\n          <Form.Label>Immagine di Copertina</Form.Label>\r\n          <Form.Control\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            onChange={handleImageChange}\r\n            required\r\n          />\r\n          {previewUrl && (\r\n            <img \r\n              src={previewUrl} \r\n              alt=\"Preview\" \r\n              className=\"mt-2\" \r\n              style={{ maxWidth: '200px' }} \r\n            />\r\n          )}\r\n        </Form.Group>\r\n\r\n        <Form.Group className=\"mb-3\">\r\n          <Form.Label>Contenuto</Form.Label>\r\n          <Form.Control\r\n            as=\"textarea\"\r\n            rows={5}\r\n            value={formData.content}\r\n            onChange={(e) => setFormData({ ...formData, content: e.target.value })}\r\n            required\r\n          />\r\n        </Form.Group>\r\n\r\n        <Form.Group className=\"mb-3\">\r\n          <Form.Label>Tempo di Lettura</Form.Label>\r\n          <div className=\"d-flex gap-2\">\r\n            <Form.Control\r\n              type=\"number\"\r\n              value={formData.readTime.value}\r\n              onChange={(e) => setFormData({ \r\n                ...formData, \r\n                readTime: { ...formData.readTime, value: parseInt(e.target.value) || 1 },\r\n              })}\r\n              required\r\n              min=\"1\"\r\n            />\r\n            <Form.Select\r\n              value={formData.readTime.unit}\r\n              onChange={(e) => setFormData({\r\n                ...formData,\r\n                readTime: { ...formData.readTime, unit: e.target.value },\r\n              })}\r\n            >\r\n              <option value=\"minuti\">Minuti</option>\r\n              <option value=\"ore\">Ore</option>\r\n            </Form.Select>\r\n          </div>\r\n        </Form.Group>\r\n\r\n        <Button variant=\"primary\" type=\"submit\">\r\n          Crea Blog\r\n        </Button>\r\n      </Form>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default CreateBlog;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}